(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"A/5D":function(t,e,n){t.exports=function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=n(t),o=n(e),r=i.default.helpers,s=function(){if("undefined"!=typeof window)return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)}}(),a={resolveOption:(t,e)=>r.valueOrDefault(t.options.realtime[e],t.chart.options.plugins.streaming[e]),startFrameRefreshTimer:function(t,e){if(!t.frameRequestID){var n=function(){e(),t.frameRequestID=r.requestAnimFrame.call(window,n)};t.frameRequestID=r.requestAnimFrame.call(window,n)}},stopFrameRefreshTimer:function(t){var e=t.frameRequestID;e&&(s.call(window,e),delete t.frameRequestID)}};function c(t,e,n){return null!=(i=e)&&("number"==typeof i?isFinite(i):i)?{value:t.getPixelForValue(e),transitionable:!0}:{value:n};var i}var l={attachChart(t){var e,n,o,r,s=t.streaming;s.annotationPlugin||(o=(e=i.default.Annotation.types.box).prototype.configure,r=(n=i.default.Annotation.types.line).prototype.configure,e.prototype.configure=function(){return a=(i=this.chartInstance).chartArea,u=(s=i.scales)[l=(r=this.options).xScaleID],p=s[d=r.yScaleID],h=this._streaming={},u&&(t=c(u,r.xMin,a.left),e=c(u,r.xMax,a.right),n=t.value>e.value,t.transitionable&&(h[n?"right":"left"]={axisId:l}),e.transitionable&&(h[n?"left":"right"]={axisId:l})),p&&(t=c(p,r.yMin,a.top),e=c(p,r.yMax,a.bottom),n=t.value>e.value,t.transitionable&&(h[n?"bottom":"top"]={axisId:d}),e.transitionable&&(h[n?"top":"bottom"]={axisId:d})),o.call(this);var t,e,n,i,r,s,a,l,d,u,p,h},n.prototype.configure=function(){return function(t){var e=t.options,n=e.scaleID,i=e.value,o=t.chartInstance.scales[n],r=t._streaming={};if(o){var s=o.isHorizontal();c(o,i).transitionable&&(r[s?"x1":"y1"]={axisId:n},r[s?"x2":"y2"]={axisId:n},r[s?"labelX":"labelY"]={axisId:n})}}(this),r.call(this)},s.annotationPlugin=!0)},getElements(t){var e=t.annotation;if(e){var n=e.elements;return Object.keys(n).map(function(t){return n[t]})}return[]},detachChart(t){delete t.streaming.annotationPlugin}},d=i.default.helpers,u=i.default.Zoom=i.default.Zoom||{};function p(t,e){if(t.scaleAxes&&t.rangeMax&&!d.isNullOrUndef(t.rangeMax[t.scaleAxes])){var n=t.rangeMax[t.scaleAxes];e>n&&(e=n)}return e}function h(t,e){if(t.scaleAxes&&t.rangeMin&&!d.isNullOrUndef(t.rangeMin[t.scaleAxes])){var n=t.rangeMin[t.scaleAxes];e<n&&(e=n)}return e}function b(t,e,n,i){var o,r,s=t.options.realtime,c=a.resolveOption(t,"duration"),l=a.resolveOption(t,"delay"),d=c*(2-e);o=t.isHorizontal()?(t.right-n.x)/(t.right-t.left):(t.bottom-n.y)/(t.bottom-t.top),r=e<1?p(i,d):h(i,d),s.duration=r,s.delay=l+o*(c-r)}function f(t,e,n){var i=t.options.realtime,o=a.resolveOption(t,"delay")+(t.getValueForPixel(e)-t.getValueForPixel(0));i.delay=e>0?p(n,o):h(n,o)}u.zoomFunctions=u.zoomFunctions||{},u.panFunctions=u.panFunctions||{};var m={attachChart(t){var e=t.streaming;e.zoomPlugin||(u.zoomFunctions.realtime=b,u.panFunctions.realtime=f,e.resetZoom=t.resetZoom,function(t){var e=t.$zoom||{_originalOptions:{}},n=t.resetZoom,i=t.update,o=function(){d.each(t.scales,function(t){var n=t.options.realtime,i=e._originalOptions[t.id]||t.originalOptions;n&&(i?(n.duration=i.realtime.duration,n.delay=i.realtime.delay):(delete n.duration,delete n.delay))}),i.call(t,{duration:0})};t.resetZoom=function(){t.update=o,n(),t.update=i}}(t),e.zoomPlugin=!0)},detachChart(t){var e=t.streaming;e.zoomPlugin&&(t.resetZoom=e.resetZoom,delete e.resetZoom,delete e.zoomPlugin)}},g=i.default.helpers,v=g.canvas,O=i.default.scaleService,y=O.getScaleConstructor("time");O.getScaleConstructor=function(t){return"time"===t&&(t="realtime"),this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0};var k=Number.MAX_SAFE_INTEGER||9007199254740991,C={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},x=Object.keys(C),w={parse:function(t,e){return"string"==typeof t&&"string"==typeof e?t=o.default(t,e):t instanceof o.default||(t=o.default(t)),t.isValid()?t.valueOf():null},add:function(t,e,n){return o.default(t).add(e,n).valueOf()},startOf:function(t,e,n){return t=o.default(t),"isoWeek"===e?t.isoWeekday(n).valueOf():t.startOf(e).valueOf()}};function S(t,e){if(g.isNullOrUndef(e))return null;var n=t.options.time,i=function(t,e){var n=t._adapter||w,i=t.options.time,o=i.parser,r=o||i.format,s=e;return"function"==typeof o&&(s=o(s)),("number"==typeof s||s instanceof Number)&&isFinite(s)||(s="string"==typeof r?n.parse(s,r):n.parse(s)),null!==s?+s:(o||"function"!=typeof r||("number"==typeof(s=r(e))||s instanceof Number)&&isFinite(s)||(s=n.parse(s)),s)}(t,t.getRightValue(e));return null===i||n.round&&(i=+(t._adapter||w).startOf(i,n.round)),i}function T(t,e,n,i){var o,r=t._adapter||w,s=t.options,a=s.time,c=a.unit||function(t,e,n,i){var o,r,s=x.length;for(o=x.indexOf(t);o<s-1;++o)if((r=C[x[o]]).common&&Math.ceil((n-e)/((r.steps?r.steps[r.steps.length-1]:k)*r.size))<=i)return x[o];return x[s-1]}(a.minUnit,e,n,i),l=function(t){for(var e=x.indexOf(t)+1,n=x.length;e<n;++e)if(C[x[e]].common)return x[e]}(c),d=g.valueOrDefault(a.stepSize,a.unitStepSize),u="week"===c&&a.isoWeekday,p=s.ticks.major.enabled,h=C[c],b=e,f=n,m=[];for(d||(d=function(t,e,n,i){var o,r,s,a=e-t,c=C[n],l=c.size,d=c.steps;if(!d)return Math.ceil(a/(i*l));for(o=0,r=d.length;o<r&&(s=d[o],!(Math.ceil(a/(l*s))<=i));++o);return s}(e,n,c,i)),u&&(b=+r.startOf(b,"isoWeek",u),f=+r.startOf(f,"isoWeek",u)),b=+r.startOf(b,u?"day":c),(f=+r.startOf(f,u?"day":c))<n&&(f=+r.add(f,1,c)),o=b,p&&l&&!u&&!a.round&&(o=+r.startOf(o,l),o=+r.add(o,~~((b-o)/(h.size*d))*d,c));o<f;o=+r.add(o,d,c))m.push(+o);return m.push(+o),m}var _=["pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointRotation","pointStyle","pointHitRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointHoverRadius","backgroundColor","borderColor","borderSkipped","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","radius","rotation"];function j(t){var e=t.realtime,n=e.refreshTimerID;n&&(clearInterval(n),delete e.refreshTimerID,delete e.refreshInterval)}function D(t){var e=t.realtime,n=a.resolveOption(t,"refresh");e.refreshTimerID=setInterval(function(){var n=a.resolveOption(t,"refresh");(function(t){var e,n,i,o,r,s,c,l=t.chart,d=t.id,u=a.resolveOption(t,"duration"),p=a.resolveOption(t,"delay"),h=a.resolveOption(t,"ttl"),b=a.resolveOption(t,"pause"),f=a.resolveOption(t,"onRefresh"),m=t.max,v=Date.now()-(isNaN(h)?u+p:h);f&&f(l),g.each(l.data.datasets,function(a,u){if(e=l.getDatasetMeta(u),d===e.xAxisID||d===e.yAxisID){if(i=(n=a.data).length,b){for(o=0;o<i&&t._getTimeForIndex(o,u)<m;++o);r=o+2}else r=0;for(o=r;o<i&&t._getTimeForIndex(o,u)<=v;++o);s=o-r,isNaN(h)&&(s=Math.max(s-2,0)),n.splice(r,s),g.each(_,function(t){g.isArray(a[t])&&a[t].splice(r,s)}),g.each(a.datalabels,function(t){g.isArray(t)&&t.splice(r,s)}),"object"!=typeof n[0]&&(c={start:r,count:s})}}),c&&l.data.labels.splice(c.start,c.count),l.update({preservation:!0})})(t),e.refreshInterval===n||isNaN(n)||(j(t),D(t))},n),e.refreshInterval=n}function I(t,e,n){var i=t._start||{},o=t._view||{},r=t._model||{};g.each(t._streaming,(t,s)=>{t.axisId===e&&(i.hasOwnProperty(s)&&(i[s]-=n),o.hasOwnProperty(s)&&o!==i&&(o[s]-=n),r.hasOwnProperty(s)&&r!==o&&(r[s]-=n))})}function M(t){var e,n,i=t.chart,o=t.realtime,r=t.id,s=a.resolveOption(t,"duration"),c=a.resolveOption(t,"delay"),d=t.isHorizontal(),u=d?t.width:t.height,p=Date.now(),h=t.options.ticks.reverse||!(d||"_reversePixels"in t),b=i.tooltip,f=l.getElements(i),m=u*(p-o.head)/s;for(d===h&&(m=-m),g.each(i.data.datasets,function(t,o){var s=i.getDatasetMeta(o),a=s.data||[],c=s.dataset;for(e=0,n=a.length;e<n;++e)I(a[e],r,m);c&&I(c,r,m)}),e=0,n=f.length;e<n;++e)I(f[e],r,m);I(b,r,m),t.max=t._table[1].time=p-c,t.min=t._table[0].time=t.max-s,o.head=p}var N=y.extend({initialize:function(){var t=this;y.prototype.initialize.apply(t,arguments),("time"!==t.options.type||t.chart.options.plugins.streaming)&&(t.realtime=t.realtime||{},D(t))},update:function(){var t,e=this,n=e.realtime,i=e.options,o=i.bounds,r=i.distribution,s=i.offset,c=i.ticks,l=c.autoSkip,d=c.source,u=c.min,p=c.max,h=c.major,b=h.enabled;return"time"!==i.type||e.chart.options.plugins.streaming?(a.resolveOption(e,"pause")?a.stopFrameRefreshTimer(n):(a.startFrameRefreshTimer(n,function(){M(e)}),n.head=Date.now()),i.bounds=void 0,i.distribution="linear",i.offset=!1,c.autoSkip=!1,c.source="auto"===d?"":d,c.min=-1e15,c.max=1e15,h.enabled=!0,t=y.prototype.update.apply(e,arguments),i.bounds=o,i.distribution=r,i.offset=s,c.autoSkip=l,c.source=d,c.min=u,c.max=p,h.enabled=b,t):y.prototype.update.apply(e,arguments)},buildTicks:function(){var t=this,e=t.options;if("time"===e.type&&!t.chart.options.plugins.streaming)return y.prototype.buildTicks.apply(t,arguments);var n,i=a.resolveOption(t,"duration"),o=a.resolveOption(t,"delay"),r=a.resolveOption(t,"refresh"),s=e.ticks,c=s.source,l=t._timestamps.data,d=t.realtime.head-o,u=d-i,p=[d+r,d];return""===c&&(s.source="data",t._timestamps.data=T(t,u,d+r,t.getLabelCapacity(u))),Object.defineProperty(t,"min",{get:function(){return u},set:g.noop}),Object.defineProperty(t,"max",{get:function(){return p.shift()},set:g.noop}),n=y.prototype.buildTicks.apply(t,arguments),delete t.min,delete t.max,t.min=u,t.max=d,""===c&&(s.source=c,t._timestamps.data=l),t._table=[{time:u,pos:0},{time:d,pos:1}],n},calculateTickRotation:function(){var t=this,e=t.options,n=e.ticks,i=n.maxRotation;"time"!==e.type||t.chart.options.plugins.streaming?(n.maxRotation=n.minRotation||0,y.prototype.calculateTickRotation.apply(t,arguments),n.maxRotation=i):y.prototype.calculateTickRotation.apply(t,arguments)},fit:function(){var t=this,e=t.options;y.prototype.fit.apply(t,arguments),("time"!==e.type||t.chart.options.plugins.streaming)&&e.ticks.display&&e.display&&t.isHorizontal()&&(t.paddingLeft=3,t.paddingRight=3,t.handleMargins())},draw:function(t){var e=this,n=e.chart;if("time"!==e.options.type||n.options.plugins.streaming){var i=e.ctx,o=e.isHorizontal()?{left:t.left,top:0,right:t.right,bottom:n.height}:{left:0,top:t.top,right:n.width,bottom:t.bottom};e._gridLineItems=null,e._labelItems=null,v.clipArea(i,o),y.prototype.draw.apply(e,arguments),v.unclipArea(i)}else y.prototype.draw.apply(e,arguments)},destroy:function(){var t=this;("time"!==t.options.type||t.chart.options.plugins.streaming)&&(a.stopFrameRefreshTimer(t.realtime),j(t))},_getTimeForIndex:function(t,e){var n,i=this,o=i._timestamps,r=o.datasets[e][t];return g.isNullOrUndef(r)&&(r=g.isObject(n=i.chart.data.datasets[e].data[t])?S(i,n):S(i,o.labels[t])),r}});O.registerScaleType("realtime",N,{position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},realtime:{},ticks:{autoSkip:!1,source:"auto",major:{enabled:!0}}});var P=i.default.helpers,B=P.canvas;function E(t,e,n){var i={};return P.each(e.x,function(t){i[t]={axisId:n.xAxisID}}),P.each(e.y,function(t){i[t]={axisId:n.yAxisID}}),i}i.default.defaults.global.plugins.streaming={duration:1e4,delay:0,frameRate:30,refresh:1e3,onRefresh:null,pause:!1,ttl:void 0},i.default.defaults.global.legend.onClick=function(t,e){var n=e.datasetIndex,i=this.chart,o=i.getDatasetMeta(n);o.hidden=null===o.hidden?!i.data.datasets[n].hidden:null,i.update({duration:0})};var A={x:["x","controlPointPreviousX","controlPointNextX","caretX"],y:["y","controlPointPreviousY","controlPointNextY","caretY"]};function R(t){var e,n,o,r,s,a,c=this,l=t&&t.preservation;l&&(n=c.lastActive,o=(e=c.tooltip)._lastActive,c._bufferedRender=!0,(s=c.legend)&&(a=s.update,s.update=P.noop)),i.default.prototype.update.apply(c,arguments),l&&(c._bufferedRender=!1,c._bufferedRequest=null,c.lastActive=n,e._lastActive=o,s&&(s.update=a),c.animating?i.default.animationService.animations.forEach(function(t){t.chart===c&&c.render({duration:16.66*(t.numSteps-t.currentStep)})}):c.data.datasets.forEach(function(t,e){c.getDatasetMeta(e).controller.transition(1)}),e._active&&e.update(!0),(r=c.streaming.lastMouseEvent)&&c.eventHandler(r))}function F(){var t,e=this,n=e._active&&e._active[0];return n?(t=e._chart.getDatasetMeta(n._datasetIndex),e._streaming=E(0,A,t)):e._streaming={},i.default.Tooltip.prototype.update.apply(e,arguments)}var z={id:"streaming",beforeInit:function(t){var e=t.streaming=t.streaming||{},n=e.canvas=t.canvas,i=e.mouseEventListener=function(n){var i=P.getRelativePosition(n,t);e.lastMouseEvent={type:"mousemove",chart:t,native:n,x:i.x,y:i.y}};n.addEventListener("mousedown",i),n.addEventListener("mouseup",i)},afterInit:function(t){t.update=R,t.tooltip.update=F},beforeUpdate:function(t){var e=t.options,n=e.scales;return n&&P.each(n.xAxes.concat(n.yAxes),function(t){"realtime"!==t.type&&"time"!==t.type||(e.elements.line.capBezierPoints=!1)}),t.annotation?l.attachChart(t):l.detachChart(t),t.resetZoom?m.attachChart(t):m.detachChart(t),!0},afterUpdate:function(t){var e=t.streaming,n=!0;(function(t){P.each(t.data.datasets,function(e,n){var i,o,r=t.getDatasetMeta(n),s=r.data||[],a=r.dataset;for(i=0,o=s.length;i<o;++i)s[i]._streaming=E(0,A,r);a&&(a._streaming=E(0,A,r))})})(t),P.each(t.scales,function(t){t instanceof N&&(n&=a.resolveOption(t,"pause"))}),n?a.stopFrameRefreshTimer(e):a.startFrameRefreshTimer(e,function(){!function(t){var e=t.streaming,n=1e3/(Math.max(t.options.plugins.streaming.frameRate,0)||30),i=e.lastDrawn+n||0,o=Date.now(),r=e.lastMouseEvent;i<=o&&(t.animating||t.tooltip._start||t.draw(),r&&t.eventHandler(r),e.lastDrawn=i+n>o?i:o)}(t)})},beforeDatasetDraw:function(t,e){var n=e.meta,i=t.chartArea,o={left:0,top:0,right:t.width,bottom:t.height};return n.xAxisID&&n.controller.getScaleForId(n.xAxisID)instanceof N&&(o.left=i.left,o.right=i.right),n.yAxisID&&n.controller.getScaleForId(n.yAxisID)instanceof N&&(o.top=i.top,o.bottom=i.bottom),B.clipArea(t.ctx,o),!0},afterDatasetDraw:function(t){B.unclipArea(t.ctx)},beforeEvent:function(t,e){var n=t.streaming;return"mousemove"===e.type?n.lastMouseEvent=e:"mouseout"===e.type&&delete n.lastMouseEvent,!0},destroy:function(t){var e=t.streaming,n=e.canvas,i=e.mouseEventListener;a.stopFrameRefreshTimer(e),delete t.update,delete t.tooltip.update,n.removeEventListener("mousedown",i),n.removeEventListener("mouseup",i),P.each(t.scales,function(t){t instanceof N&&t.destroy()})}};return i.default.helpers.streaming=a,i.default.plugins.register(z),z}(n("MO+k"),n("wd/R"))},D8XL:function(t,e,n){"use strict";n.r(e),n.d(e,"TradingModule",function(){return Et});var i=n("ofXK"),o=n("tyNb"),r=n("P+IX"),s=n("tqRt");const a=Object(s.p)("[Trading-Trade] Trading starting"),c=Object(s.p)("[Trading-Trade] Trading started"),l=Object(s.p)("[Trading-Trade] Trade payload",Object(s.v)()),d=Object(s.p)("[Trading-Trade] Trading ending"),u=Object(s.p)("[Trading-Trade] Trading ended");Object(s.p)("[Trading-Trade] Trading Error",Object(s.v)());var p=function(t){return t[t.DISCONNECTED=0]="DISCONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.DISCONNECTING=3]="DISCONNECTING",t}({});const h={connected:p.DISCONNECTED,trades:[],lastTrade:[]},b=Object(s.r)(h,Object(s.u)(a,t=>Object.assign(Object.assign({},t),{connected:p.CONNECTING})),Object(s.u)(c,t=>Object.assign(Object.assign({},t),{connected:p.CONNECTED})),Object(s.u)(u,t=>Object.assign(Object.assign({},t),{connected:p.DISCONNECTED,trades:h.trades})),Object(s.u)(d,t=>Object.assign(Object.assign({},t),{connected:p.DISCONNECTING})),Object(s.u)(l,(t,e)=>Object.assign(Object.assign({},t),{lastTrade:[...e.trades]})));function f(t,e){return b(t,e)}const m=Object(s.p)("[Trading-Book] Book starting"),g=Object(s.p)("[Trading-Book] Book started"),v=Object(s.p)("[Trading-Book] Book snapshot",Object(s.v)()),O=Object(s.p)("[Trading-Book] Book update",Object(s.v)()),y=Object(s.p)("[Trading-Book] Book ending"),k=Object(s.p)("[Trading-Book] Book ended");Object(s.p)("[Trading-Book] Book Error",Object(s.v)());var C=function(t){return t[t.price=0]="price",t[t.volume=1]="volume",t[t.timestamp=2]="timestamp",t}({});const x=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],w={connected:p.DISCONNECTED,bid:x,ask:x,error:""};function S(t,e,n=!1,i=10){if(!e)return t;let o=[...t];return n&&o.reverse(),e.forEach(t=>{let e=[...t.map(t=>+t)];e.length>3&&e.pop();const i=+t[C.price],r=+t[C.volume];if(t.length>3)n?o.unshift(e):o.push(e);else{const t=o.findIndex(t=>i<=t[C.price]);-1===t?o.push(e):0===r?o.splice(t,1):o.splice(t,o[t][C.price]===i?1:0,e)}}),n&&o.reverse(),o=o.slice(0,i),o}const T=Object(s.r)(w,Object(s.u)(m,t=>Object.assign(Object.assign({},t),{connected:p.CONNECTING})),Object(s.u)(g,t=>Object.assign(Object.assign({},t),{connected:p.CONNECTED})),Object(s.u)(k,t=>Object.assign(Object.assign({},t),{connected:p.DISCONNECTED})),Object(s.u)(y,t=>Object.assign(Object.assign({},t),{connected:p.DISCONNECTING})),Object(s.u)(v,(t,e)=>Object.assign(Object.assign({},t),{bid:[...e.book.bs.map(t=>t.map(t=>+t))],ask:[...e.book.as.map(t=>t.map(t=>+t))]})),Object(s.u)(O,(t,e)=>Object.assign(Object.assign({},t),{bid:S(t.bid,e.book.b,!0),ask:S(t.ask,e.book.a)})));function _(t,e){return T(t,e)}const j="trading";function D(t,e){return Object(s.n)({trades:f,book:_})(t,e)}const I=Object(s.q)(j),M=Object(s.s)(I,t=>t.trades),N=Object(s.s)(M,t=>t.connected),P=(Object(s.s)(M,t=>t.trades),Object(s.s)(M,t=>t.lastTrade)),B=Object(s.s)(I,t=>t.book),E=(Object(s.s)(B,t=>t.connected),Object(s.s)(B,t=>t.ask)),A=Object(s.s)(B,t=>t.bid);var R=n("Kj3r"),F=n("fXoL"),z=(n("A/5D"),n("LPYB"));const $=["tradeChart"];let U=(()=>{class t{constructor(t){this.store=t,this.datasets=[{label:"Bitcoin ($)",fill:!1,backgroundColor:"rgba(0, 0, 0)",borderColor:"rgba(255,243,222)",data:[],lineTension:0}],this.lineChartOptions={responsive:!0,title:{display:!1,text:""},scales:{xAxes:[{type:"realtime",realtime:{duration:6e4,refresh:200,delay:100,pause:!1,ttl:12e4},gridLines:{color:"rgb(200,200,200,0.5)",display:!0}}],yAxes:[{gridLines:{color:"rgb(200,200,200,0.5)",display:!0}}]},elements:{point:{radius:1,hitRadius:4}}}}ngAfterViewInit(){this.lastTrade$.subscribe(t=>{this.lastTrade=[...t],t.forEach(t=>{this.datasets[0].data.push({x:Date.now(),y:+t.price})}),this.tradeChart.update("none")})}ngOnInit(){this.lastTrade$=this.store.select(P)}}return t.\u0275fac=function(e){return new(e||t)(F.Ob(s.i))},t.\u0275cmp=F.Ib({type:t,selectors:[["app-trade-chart"]],viewQuery:function(t,e){if(1&t&&F.Ac($,1),2&t){let t;F.nc(t=F.cc())&&(e.tradeChart=t.first)}},decls:3,vars:3,consts:[[1,"trading-chart"],["baseChart","",3,"chartType","datasets","options"],["tradeChart","base-chart"]],template:function(t,e){1&t&&(F.Ub(0,"div",0),F.Pb(1,"canvas",1,2),F.Tb()),2&t&&(F.Db(1),F.kc("chartType","line")("datasets",e.datasets)("options",e.lineChartOptions))},directives:[z.a],styles:[".trading-chart[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;top:0;left:0}"]}),t})();var Y=n("OaSA");function W(t,e){1&t&&(F.Ub(0,"th",8),F.xc(1," $ "),F.Tb())}function H(t,e){if(1&t&&(F.Ub(0,"td",9),F.xc(1),F.fc(2,"number"),F.Tb()),2&t){const t=e.$implicit;F.Db(1),F.zc(" ",F.hc(2,1,t[0],"1.2-5")," ")}}function L(t,e){1&t&&(F.Ub(0,"th",8),F.xc(1," # "),F.Tb())}function q(t,e){if(1&t&&(F.Ub(0,"td",9),F.xc(1),F.fc(2,"number"),F.Tb()),2&t){const t=e.$implicit;F.Db(1),F.zc(" ",F.hc(2,1,t[1],"1.5-5")," ")}}function X(t,e){1&t&&(F.Ub(0,"th",8),F.xc(1," Date/Time "),F.Tb())}function G(t,e){if(1&t&&(F.Ub(0,"td",9),F.xc(1),F.fc(2,"date"),F.Tb()),2&t){const t=e.$implicit;F.Db(1),F.zc(" ",F.hc(2,1,1e3*t[2],"mediumTime")," ")}}function Z(t,e){1&t&&F.Pb(0,"tr",10)}function V(t,e){1&t&&F.Pb(0,"tr",11)}let K=(()=>{class t{constructor(){this.orderBook=[][3],this.isBid=!1,this.displayedColumns=["price","volume","date"]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=F.Ib({type:t,selectors:[["app-order-book"]],inputs:{orderBook:"orderBook",isBid:"isBid"},decls:14,vars:6,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","price"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","volume"],["matColumnDef","date"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(F.Ub(0,"h4"),F.xc(1),F.Tb(),F.Ub(2,"table",0),F.Sb(3,1),F.wc(4,W,2,0,"th",2),F.wc(5,H,3,4,"td",3),F.Rb(),F.Sb(6,4),F.wc(7,L,2,0,"th",2),F.wc(8,q,3,4,"td",3),F.Rb(),F.Sb(9,5),F.wc(10,X,2,0,"th",2),F.wc(11,G,3,4,"td",3),F.Rb(),F.wc(12,Z,1,0,"tr",6),F.wc(13,V,1,0,"tr",7),F.Tb()),2&t&&(F.Db(1),F.yc(e.isBid?"Buy":"Sell"),F.Db(1),F.Gb("bid-group",e.isBid),F.kc("dataSource",e.orderBook),F.Db(10),F.kc("matHeaderRowDef",e.displayedColumns),F.Db(1),F.kc("matRowDefColumns",e.displayedColumns))},directives:[Y.j,Y.c,Y.e,Y.b,Y.g,Y.i,Y.d,Y.a,Y.f,Y.h],pipes:[i.e,i.d],styles:[".mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{padding:0 .2rem;text-align:center}.mat-header-cell[_ngcontent-%COMP%]{color:wheat}.mat-cell[_ngcontent-%COMP%]{color:red}mat-footer-row[_ngcontent-%COMP%], mat-header-row[_ngcontent-%COMP%], mat-row[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%], th.mat-header-cell[_ngcontent-%COMP%]{border-bottom-color:wheat}.bid-group[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{color:#0f0}h4[_ngcontent-%COMP%]{text-align:center;color:wheat;margin:1rem .2rem .2rem}@media screen and (min-width:1200px){h4[_ngcontent-%COMP%]{margin-top:2rem}}td.mat-cell[_ngcontent-%COMP%]:last-of-type, th.mat-header-cell[_ngcontent-%COMP%]:last-of-type{padding-right:.2 rem}td.mat-cell[_ngcontent-%COMP%]:first-of-type, th.mat-header-cell[_ngcontent-%COMP%]:first-of-type{padding-left:.2 rem}tr.mat-header-row[_ngcontent-%COMP%], tr.mat-row[_ngcontent-%COMP%]{height:1.5rem}table[_ngcontent-%COMP%]{font-family:Inconsolata,monospace;background:#000;border-color:wheat}"]}),t})();const J=[{path:"",component:(()=>{class t{constructor(t){this.store=t}ngOnDestroy(){this.store.dispatch(d()),this.store.dispatch(y())}ngOnInit(){this.connected$=this.store.select(N),this.askBook$=this.store.select(E).pipe(Object(R.a)(100)),this.bidBook$=this.store.select(A).pipe(Object(R.a)(100)),this.store.dispatch(a()),this.store.dispatch(m())}Start(){this.store.dispatch(a())}Stop(){this.store.dispatch(d())}StartBook(){this.store.dispatch(m())}StopBook(){this.store.dispatch(y())}}return t.\u0275fac=function(e){return new(e||t)(F.Ob(s.i))},t.\u0275cmp=F.Ib({type:t,selectors:[["app-trading"]],decls:4,vars:4,consts:[[1,"trading-section"],[3,"isBid","orderBook"]],template:function(t,e){1&t&&(F.Ub(0,"section",0),F.Pb(1,"app-trade-chart"),F.Pb(2,"app-order-book",1),F.Pb(3,"app-order-book",1),F.Tb()),2&t&&(F.Db(2),F.kc("isBid",!0)("orderBook",e.bidBook$),F.Db(1),F.kc("isBid",!1)("orderBook",e.askBook$))},directives:[U,K],styles:["[_nghost-%COMP%]{background:#000;display:flex;justify-content:stretch;width:100%;flex-direction:column;min-height:100%;padding-bottom:1rem}.trading-section[_ngcontent-%COMP%]{justify-content:space-around}.trading-section[_ngcontent-%COMP%], .trading-section[_ngcontent-%COMP%]   app-trade-chart[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.trading-section[_ngcontent-%COMP%]   app-trade-chart[_ngcontent-%COMP%]{width:80%;min-height:15rem;margin-top:1rem;position:relative}@media screen and (min-width:1200px){[_nghost-%COMP%]{height:100%}.trading-section[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start;flex-wrap:wrap;justify-content:center}.trading-section[_ngcontent-%COMP%]   app-trade-chart[_ngcontent-%COMP%]{width:45%}.trading-section[_ngcontent-%COMP%]   app-order-book[_ngcontent-%COMP%]{padding-left:1rem}}"]}),t})(),canActivate:[r.a]}];let Q=(()=>{class t{}return t.\u0275mod=F.Mb({type:t}),t.\u0275inj=F.Lb({factory:function(e){return new(e||t)},imports:[[o.i.forChild(J)],o.i]}),t})();var tt=n("7bNT"),et=n("vkgz"),nt=n("XNiG"),it=n("7o/Q"),ot=n("HDdC"),rt=n("quSY"),st=n("jtHE");const at={url:"",deserializer:t=>JSON.parse(t.data),serializer:t=>JSON.stringify(t)};class ct extends nt.a{constructor(t,e){if(super(),t instanceof ot.a)this.destination=e,this.source=t;else{const e=this._config=Object.assign({},at);if(this._output=new nt.b,"string"==typeof t)e.url=t;else for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);if(!e.WebSocketCtor&&WebSocket)e.WebSocketCtor=WebSocket;else if(!e.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new st.a}}lift(t){const e=new ct(this._config,this.destination);return e.operator=t,e.source=this,e}_resetState(){this._socket=null,this.source||(this.destination=new st.a),this._output=new nt.b}multiplex(t,e,n){const i=this;return new ot.a(o=>{try{i.next(t())}catch(s){o.error(s)}const r=i.subscribe(t=>{try{n(t)&&o.next(t)}catch(s){o.error(s)}},t=>o.error(t),()=>o.complete());return()=>{try{i.next(e())}catch(s){o.error(s)}r.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:t,protocol:e,url:n,binaryType:i}=this._config,o=this._output;let r=null;try{r=e?new t(n,e):new t(n),this._socket=r,i&&(this._socket.binaryType=i)}catch(a){return void o.error(a)}const s=new rt.a(()=>{this._socket=null,r&&1===r.readyState&&r.close()});r.onopen=t=>{const{_socket:e}=this;if(!e)return r.close(),void this._resetState();const{openObserver:n}=this._config;n&&n.next(t);const i=this.destination;this.destination=it.a.create(e=>{if(1===r.readyState)try{const{serializer:t}=this._config;r.send(t(e))}catch(t){this.destination.error(t)}},t=>{const{closingObserver:e}=this._config;e&&e.next(void 0),t&&t.code?r.close(t.code,t.reason):o.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:t}=this._config;t&&t.next(void 0),r.close(),this._resetState()}),i&&i instanceof st.a&&s.add(i.subscribe(this.destination))},r.onerror=t=>{this._resetState(),o.error(t)},r.onclose=t=>{this._resetState();const{closeObserver:e}=this._config;e&&e.next(t),t.wasClean?o.complete():o.error(t)},r.onmessage=t=>{try{const{deserializer:e}=this._config;o.next(e(t))}catch(e){o.error(e)}}}_subscribe(t){const{source:e}=this;return e?e.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(()=>{const{_socket:t}=this;0===this._output.observers.length&&(t&&1===t.readyState&&t.close(),this._resetState())}),t)}unsubscribe(){const{_socket:t}=this;t&&1===t.readyState&&t.close(),this._resetState(),super.unsubscribe()}}var lt=n("AytR"),dt=n("2Vo4"),ut=n("EY2u"),pt=n("PqYM"),ht=n("eIep"),bt=n("SpAZ"),ft=n("JIr8"),mt=n("zx2A");class gt{constructor(t,e){this.notifier=t,this.source=e}call(t,e){return e.subscribe(new vt(t,this.notifier,this.source))}}class vt extends mt.b{constructor(t,e,n){super(t),this.notifier=e,this.source=n}error(t){if(!this.isStopped){let n=this.errors,i=this.retries,o=this.retriesSubscription;if(i)this.errors=void 0,this.retriesSubscription=void 0;else{n=new nt.b;try{const{notifier:t}=this;i=t(n)}catch(e){return super.error(e)}o=Object(mt.c)(i,new mt.a(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=i,this.retriesSubscription=o,n.next(t)}}_unsubscribe(){const{errors:t,retriesSubscription:e}=this;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0}notifyNext(){const{_unsubscribe:t}=this;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)}}var Ot=n("l7GE"),yt=n("ZUHj");class kt{constructor(t){this.delayDurationSelector=t}call(t,e){return e.subscribe(new Ct(t,this.delayDurationSelector))}}class Ct extends Ot.a{constructor(t,e){super(t),this.delayDurationSelector=e,this.completed=!1,this.delayNotifierSubscriptions=[],this.index=0}notifyNext(t,e,n,i,o){this.destination.next(t),this.removeSubscription(o),this.tryComplete()}notifyError(t,e){this._error(t)}notifyComplete(t){const e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()}_next(t){const e=this.index++;try{const n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(n){this.destination.error(n)}}_complete(){this.completed=!0,this.tryComplete(),this.unsubscribe()}removeSubscription(t){t.unsubscribe();const e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue}tryDelay(t,e){const n=Object(yt.a)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))}tryComplete(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()}}const xt=Object(s.p)("[Trading Traffic] new traffic",Object(s.v)()),wt=Object(s.p)("[Trading Traffic] Traffic Cop unhandled traffic",Object(s.v)()),St=lt.a.BITCOIN_WEBSOCKET_URL,Tt=lt.a.BITCOIN_RECONNECT_INTERVAL;let _t=(()=>{class t{constructor(t){this.store=t,this.messagesSubject$=new dt.a(null),this.messages$=this.messagesSubject$.pipe(Object(ht.a)(bt.a),Object(ft.a)(t=>{throw t})),this.subscription=null,this.bookStarted=!1,this.tradeStarted=!1}connect(t={reconnect:!1}){if(!this.socket$||this.socket$.closed){this.socket$=this.getNewWebSocket();const e=this.socket$.pipe(t.reconnect?this.reconnect:t=>t,Object(et.a)({error:t=>console.log(t)}),Object(ft.a)(t=>ut.a));this.messagesSubject$.next(e)}}reconnect(t){return t.pipe((e=t=>{return t.pipe(Object(et.a)(t=>console.log("[TradingService] Try to reconnect",t)),(e=t=>Object(pt.a)(Tt),t=>t.lift(new kt(e))));var e},t=>t.lift(new gt(e,t))));var e}close(){this.socket$.complete(),this.socket$=void 0}sendMessage(t){console.log("sendMessage"),this.socket$.next(t)}getNewWebSocket(){return new ct({url:St,openObserver:{next:()=>{console.log("[TradingService]: connection ok")}},closeObserver:{next:()=>{var t;console.log("[TradingService]: connection closed"),null===(t=this.socket$)||void 0===t||t.complete(),this.socket$=void 0,this.tradeStarted=!1,this.bookStarted=!1,this.store.dispatch(u()),this.store.dispatch(k())}}})}startTradeFeed(){this.tradeStarted=!0,this.connect(),this.checkSubscription(),this.sendMessage({event:"subscribe",pair:["XBT/USD"],subscription:{name:"trade"}})}checkSubscription(){this.subscription||(this.subscription=this.messages$.subscribe(t=>{this.store.dispatch(xt({data:t}))}))}stopTradeFeed(){this.sendMessage({event:"unsubscribe",pair:["XBT/USD"],subscription:{name:"trade"}}),this.tradeStarted=!1,this.bookStarted||this.tradeStarted||this.close()}startBookFeed(){this.bookStarted=!0,this.connect(),this.checkSubscription(),this.sendMessage({event:"subscribe",pair:["XBT/USD"],subscription:{name:"book"}})}stopBookFeed(){this.sendMessage({event:"unsubscribe",pair:["XBT/USD"],subscription:{name:"book"}}),this.bookStarted=!1,this.bookStarted||this.tradeStarted||this.close()}}return t.\u0275fac=function(e){return new(e||t)(F.Yb(s.i))},t.\u0275prov=F.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),jt=(()=>{class t{constructor(t,e){this.actions$=t,this.service=e,this.connectTrade$=Object(tt.d)(()=>this.actions$.pipe(Object(tt.e)(a),Object(et.a)(()=>this.service.startTradeFeed())),{dispatch:!1}),this.disconnectTrade$=Object(tt.d)(()=>this.actions$.pipe(Object(tt.e)(d),Object(et.a)(()=>this.service.stopTradeFeed())),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(F.Yb(tt.a),F.Yb(_t))},t.\u0275prov=F.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Dt=n("lJxs"),It=function(t){return t.Book="book-10",t.Trade="trade",t}({}),Mt=function(t){return t.Ping="ping",t.Pong="pong",t.Heartbeat="heartbeat",t.SystemStatus="systemStatus",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",t.SubscriptionStatus="subscriptionStatus",t}({});let Nt=(()=>{class t{constructor(t){this.actions$=t,this.trafficCopEffect$=Object(tt.d)(()=>this.actions$.pipe(Object(tt.e)(xt),Object(Dt.a)(t=>{var e,n,i,o;if(Array.isArray(t.data))switch(t.data[t.data.length-2]){case It.Trade:const e=t.data[1].map(t=>({price:t[0],volume:t[1],time:t[2],side:t[3],orderType:t[4],misc:t[5]}));return l({trades:e});case It.Book:const n=t.data[1];if((null==n?void 0:n.as)&&(null==n?void 0:n.bs))return v({book:n});if((null==n?void 0:n.a)||(null==n?void 0:n.b))return O({book:n})}else{const r=t.data;if(null==r?void 0:r.event)switch(r.event){case Mt.SubscriptionStatus:if((null==r?void 0:r.status)==Mt.Subscribe){if((null===(e=null==r?void 0:r.subscription)||void 0===e?void 0:e.name)==It.Trade)return c();if((null===(n=null==r?void 0:r.subscription)||void 0===n?void 0:n.name)==It.Book)return g()}else if((null==r?void 0:r.status)==Mt.Unsubscribe){if((null===(i=null==r?void 0:r.subscription)||void 0===i?void 0:i.name)==It.Trade)return u();if((null===(o=null==r?void 0:r.subscription)||void 0===o?void 0:o.name)==It.Book)return k()}}}return wt({data:t.data})})))}}return t.\u0275fac=function(e){return new(e||t)(F.Yb(tt.a))},t.\u0275prov=F.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Pt=n("pKmL");let Bt=(()=>{class t{constructor(t,e){this.actions$=t,this.service=e,this.connectBook$=Object(tt.d)(()=>this.actions$.pipe(Object(tt.e)(m),Object(et.a)(()=>this.service.startBookFeed())),{dispatch:!1}),this.disconnectBook$=Object(tt.d)(()=>this.actions$.pipe(Object(tt.e)(y),Object(et.a)(()=>this.service.stopBookFeed())),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(F.Yb(tt.a),F.Yb(_t))},t.\u0275prov=F.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Et=(()=>{class t{}return t.\u0275mod=F.Mb({type:t}),t.\u0275inj=F.Lb({factory:function(e){return new(e||t)},imports:[[i.b,Q,s.k.forFeature(j,D),tt.b.forFeature([Nt,jt,Bt]),Pt.a,z.b]]}),t})()}}]);