(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"A/5D":function(t,e,n){t.exports=function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=n(t),r=n(e),o=i.default.helpers,s=function(){if("undefined"!=typeof window)return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)}}(),a={resolveOption:(t,e)=>o.valueOrDefault(t.options.realtime[e],t.chart.options.plugins.streaming[e]),startFrameRefreshTimer:function(t,e){if(!t.frameRequestID){var n=function(){e(),t.frameRequestID=o.requestAnimFrame.call(window,n)};t.frameRequestID=o.requestAnimFrame.call(window,n)}},stopFrameRefreshTimer:function(t){var e=t.frameRequestID;e&&(s.call(window,e),delete t.frameRequestID)}};function c(t,e,n){return null!=(i=e)&&("number"==typeof i?isFinite(i):i)?{value:t.getPixelForValue(e),transitionable:!0}:{value:n};var i}var d={attachChart(t){var e,n,r,o,s=t.streaming;s.annotationPlugin||(r=(e=i.default.Annotation.types.box).prototype.configure,o=(n=i.default.Annotation.types.line).prototype.configure,e.prototype.configure=function(){return a=(i=this.chartInstance).chartArea,u=(s=i.scales)[d=(o=this.options).xScaleID],p=s[l=o.yScaleID],h=this._streaming={},u&&(t=c(u,o.xMin,a.left),e=c(u,o.xMax,a.right),n=t.value>e.value,t.transitionable&&(h[n?"right":"left"]={axisId:d}),e.transitionable&&(h[n?"left":"right"]={axisId:d})),p&&(t=c(p,o.yMin,a.top),e=c(p,o.yMax,a.bottom),n=t.value>e.value,t.transitionable&&(h[n?"bottom":"top"]={axisId:l}),e.transitionable&&(h[n?"top":"bottom"]={axisId:l})),r.call(this);var t,e,n,i,o,s,a,d,l,u,p,h},n.prototype.configure=function(){return function(t){var e=t.options,n=e.scaleID,i=e.value,r=t.chartInstance.scales[n],o=t._streaming={};if(r){var s=r.isHorizontal();c(r,i).transitionable&&(o[s?"x1":"y1"]={axisId:n},o[s?"x2":"y2"]={axisId:n},o[s?"labelX":"labelY"]={axisId:n})}}(this),o.call(this)},s.annotationPlugin=!0)},getElements(t){var e=t.annotation;if(e){var n=e.elements;return Object.keys(n).map(function(t){return n[t]})}return[]},detachChart(t){delete t.streaming.annotationPlugin}},l=i.default.helpers,u=i.default.Zoom=i.default.Zoom||{};function p(t,e){if(t.scaleAxes&&t.rangeMax&&!l.isNullOrUndef(t.rangeMax[t.scaleAxes])){var n=t.rangeMax[t.scaleAxes];e>n&&(e=n)}return e}function h(t,e){if(t.scaleAxes&&t.rangeMin&&!l.isNullOrUndef(t.rangeMin[t.scaleAxes])){var n=t.rangeMin[t.scaleAxes];e<n&&(e=n)}return e}function b(t,e,n,i){var r,o,s=t.options.realtime,c=a.resolveOption(t,"duration"),d=a.resolveOption(t,"delay"),l=c*(2-e);r=t.isHorizontal()?(t.right-n.x)/(t.right-t.left):(t.bottom-n.y)/(t.bottom-t.top),o=e<1?p(i,l):h(i,l),s.duration=o,s.delay=d+r*(c-o)}function f(t,e,n){var i=t.options.realtime,r=a.resolveOption(t,"delay")+(t.getValueForPixel(e)-t.getValueForPixel(0));i.delay=e>0?p(n,r):h(n,r)}u.zoomFunctions=u.zoomFunctions||{},u.panFunctions=u.panFunctions||{};var m={attachChart(t){var e=t.streaming;e.zoomPlugin||(u.zoomFunctions.realtime=b,u.panFunctions.realtime=f,e.resetZoom=t.resetZoom,function(t){var e=t.$zoom||{_originalOptions:{}},n=t.resetZoom,i=t.update,r=function(){l.each(t.scales,function(t){var n=t.options.realtime,i=e._originalOptions[t.id]||t.originalOptions;n&&(i?(n.duration=i.realtime.duration,n.delay=i.realtime.delay):(delete n.duration,delete n.delay))}),i.call(t,{duration:0})};t.resetZoom=function(){t.update=r,n(),t.update=i}}(t),e.zoomPlugin=!0)},detachChart(t){var e=t.streaming;e.zoomPlugin&&(t.resetZoom=e.resetZoom,delete e.resetZoom,delete e.zoomPlugin)}},g=i.default.helpers,v=g.canvas,O=i.default.scaleService,y=O.getScaleConstructor("time");O.getScaleConstructor=function(t){return"time"===t&&(t="realtime"),this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0};var k=Number.MAX_SAFE_INTEGER||9007199254740991,x={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},w=Object.keys(x),C={parse:function(t,e){return"string"==typeof t&&"string"==typeof e?t=r.default(t,e):t instanceof r.default||(t=r.default(t)),t.isValid()?t.valueOf():null},add:function(t,e,n){return r.default(t).add(e,n).valueOf()},startOf:function(t,e,n){return t=r.default(t),"isoWeek"===e?t.isoWeekday(n).valueOf():t.startOf(e).valueOf()}};function _(t,e){if(g.isNullOrUndef(e))return null;var n=t.options.time,i=function(t,e){var n=t._adapter||C,i=t.options.time,r=i.parser,o=r||i.format,s=e;return"function"==typeof r&&(s=r(s)),("number"==typeof s||s instanceof Number)&&isFinite(s)||(s="string"==typeof o?n.parse(s,o):n.parse(s)),null!==s?+s:(r||"function"!=typeof o||("number"==typeof(s=o(e))||s instanceof Number)&&isFinite(s)||(s=n.parse(s)),s)}(t,t.getRightValue(e));return null===i||n.round&&(i=+(t._adapter||C).startOf(i,n.round)),i}function S(t,e,n,i){var r,o=t._adapter||C,s=t.options,a=s.time,c=a.unit||function(t,e,n,i){var r,o,s=w.length;for(r=w.indexOf(t);r<s-1;++r)if((o=x[w[r]]).common&&Math.ceil((n-e)/((o.steps?o.steps[o.steps.length-1]:k)*o.size))<=i)return w[r];return w[s-1]}(a.minUnit,e,n,i),d=function(t){for(var e=w.indexOf(t)+1,n=w.length;e<n;++e)if(x[w[e]].common)return w[e]}(c),l=g.valueOrDefault(a.stepSize,a.unitStepSize),u="week"===c&&a.isoWeekday,p=s.ticks.major.enabled,h=x[c],b=e,f=n,m=[];for(l||(l=function(t,e,n,i){var r,o,s,a=e-t,c=x[n],d=c.size,l=c.steps;if(!l)return Math.ceil(a/(i*d));for(r=0,o=l.length;r<o&&(s=l[r],!(Math.ceil(a/(d*s))<=i));++r);return s}(e,n,c,i)),u&&(b=+o.startOf(b,"isoWeek",u),f=+o.startOf(f,"isoWeek",u)),b=+o.startOf(b,u?"day":c),(f=+o.startOf(f,u?"day":c))<n&&(f=+o.add(f,1,c)),r=b,p&&d&&!u&&!a.round&&(r=+o.startOf(r,d),r=+o.add(r,~~((b-r)/(h.size*l))*l,c));r<f;r=+o.add(r,l,c))m.push(+r);return m.push(+r),m}var T=["pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointRotation","pointStyle","pointHitRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointHoverRadius","backgroundColor","borderColor","borderSkipped","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","radius","rotation"];function j(t){var e=t.realtime,n=e.refreshTimerID;n&&(clearInterval(n),delete e.refreshTimerID,delete e.refreshInterval)}function D(t){var e=t.realtime,n=a.resolveOption(t,"refresh");e.refreshTimerID=setInterval(function(){var n=a.resolveOption(t,"refresh");(function(t){var e,n,i,r,o,s,c,d=t.chart,l=t.id,u=a.resolveOption(t,"duration"),p=a.resolveOption(t,"delay"),h=a.resolveOption(t,"ttl"),b=a.resolveOption(t,"pause"),f=a.resolveOption(t,"onRefresh"),m=t.max,v=Date.now()-(isNaN(h)?u+p:h);f&&f(d),g.each(d.data.datasets,function(a,u){if(e=d.getDatasetMeta(u),l===e.xAxisID||l===e.yAxisID){if(i=(n=a.data).length,b){for(r=0;r<i&&t._getTimeForIndex(r,u)<m;++r);o=r+2}else o=0;for(r=o;r<i&&t._getTimeForIndex(r,u)<=v;++r);s=r-o,isNaN(h)&&(s=Math.max(s-2,0)),n.splice(o,s),g.each(T,function(t){g.isArray(a[t])&&a[t].splice(o,s)}),g.each(a.datalabels,function(t){g.isArray(t)&&t.splice(o,s)}),"object"!=typeof n[0]&&(c={start:o,count:s})}}),c&&d.data.labels.splice(c.start,c.count),d.update({preservation:!0})})(t),e.refreshInterval===n||isNaN(n)||(j(t),D(t))},n),e.refreshInterval=n}function I(t,e,n){var i=t._start||{},r=t._view||{},o=t._model||{};g.each(t._streaming,(t,s)=>{t.axisId===e&&(i.hasOwnProperty(s)&&(i[s]-=n),r.hasOwnProperty(s)&&r!==i&&(r[s]-=n),o.hasOwnProperty(s)&&o!==r&&(o[s]-=n))})}function M(t){var e,n,i=t.chart,r=t.realtime,o=t.id,s=a.resolveOption(t,"duration"),c=a.resolveOption(t,"delay"),l=t.isHorizontal(),u=l?t.width:t.height,p=Date.now(),h=t.options.ticks.reverse||!(l||"_reversePixels"in t),b=i.tooltip,f=d.getElements(i),m=u*(p-r.head)/s;for(l===h&&(m=-m),g.each(i.data.datasets,function(t,r){var s=i.getDatasetMeta(r),a=s.data||[],c=s.dataset;for(e=0,n=a.length;e<n;++e)I(a[e],o,m);c&&I(c,o,m)}),e=0,n=f.length;e<n;++e)I(f[e],o,m);I(b,o,m),t.max=t._table[1].time=p-c,t.min=t._table[0].time=t.max-s,r.head=p}var N=y.extend({initialize:function(){var t=this;y.prototype.initialize.apply(t,arguments),("time"!==t.options.type||t.chart.options.plugins.streaming)&&(t.realtime=t.realtime||{},D(t))},update:function(){var t,e=this,n=e.realtime,i=e.options,r=i.bounds,o=i.distribution,s=i.offset,c=i.ticks,d=c.autoSkip,l=c.source,u=c.min,p=c.max,h=c.major,b=h.enabled;return"time"!==i.type||e.chart.options.plugins.streaming?(a.resolveOption(e,"pause")?a.stopFrameRefreshTimer(n):(a.startFrameRefreshTimer(n,function(){M(e)}),n.head=Date.now()),i.bounds=void 0,i.distribution="linear",i.offset=!1,c.autoSkip=!1,c.source="auto"===l?"":l,c.min=-1e15,c.max=1e15,h.enabled=!0,t=y.prototype.update.apply(e,arguments),i.bounds=r,i.distribution=o,i.offset=s,c.autoSkip=d,c.source=l,c.min=u,c.max=p,h.enabled=b,t):y.prototype.update.apply(e,arguments)},buildTicks:function(){var t=this,e=t.options;if("time"===e.type&&!t.chart.options.plugins.streaming)return y.prototype.buildTicks.apply(t,arguments);var n,i=a.resolveOption(t,"duration"),r=a.resolveOption(t,"delay"),o=a.resolveOption(t,"refresh"),s=e.ticks,c=s.source,d=t._timestamps.data,l=t.realtime.head-r,u=l-i,p=[l+o,l];return""===c&&(s.source="data",t._timestamps.data=S(t,u,l+o,t.getLabelCapacity(u))),Object.defineProperty(t,"min",{get:function(){return u},set:g.noop}),Object.defineProperty(t,"max",{get:function(){return p.shift()},set:g.noop}),n=y.prototype.buildTicks.apply(t,arguments),delete t.min,delete t.max,t.min=u,t.max=l,""===c&&(s.source=c,t._timestamps.data=d),t._table=[{time:u,pos:0},{time:l,pos:1}],n},calculateTickRotation:function(){var t=this,e=t.options,n=e.ticks,i=n.maxRotation;"time"!==e.type||t.chart.options.plugins.streaming?(n.maxRotation=n.minRotation||0,y.prototype.calculateTickRotation.apply(t,arguments),n.maxRotation=i):y.prototype.calculateTickRotation.apply(t,arguments)},fit:function(){var t=this,e=t.options;y.prototype.fit.apply(t,arguments),("time"!==e.type||t.chart.options.plugins.streaming)&&e.ticks.display&&e.display&&t.isHorizontal()&&(t.paddingLeft=3,t.paddingRight=3,t.handleMargins())},draw:function(t){var e=this,n=e.chart;if("time"!==e.options.type||n.options.plugins.streaming){var i=e.ctx,r=e.isHorizontal()?{left:t.left,top:0,right:t.right,bottom:n.height}:{left:0,top:t.top,right:n.width,bottom:t.bottom};e._gridLineItems=null,e._labelItems=null,v.clipArea(i,r),y.prototype.draw.apply(e,arguments),v.unclipArea(i)}else y.prototype.draw.apply(e,arguments)},destroy:function(){var t=this;("time"!==t.options.type||t.chart.options.plugins.streaming)&&(a.stopFrameRefreshTimer(t.realtime),j(t))},_getTimeForIndex:function(t,e){var n,i=this,r=i._timestamps,o=r.datasets[e][t];return g.isNullOrUndef(o)&&(o=g.isObject(n=i.chart.data.datasets[e].data[t])?_(i,n):_(i,r.labels[t])),o}});O.registerScaleType("realtime",N,{position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},realtime:{},ticks:{autoSkip:!1,source:"auto",major:{enabled:!0}}});var P=i.default.helpers,B=P.canvas;function E(t,e,n){var i={};return P.each(e.x,function(t){i[t]={axisId:n.xAxisID}}),P.each(e.y,function(t){i[t]={axisId:n.yAxisID}}),i}i.default.defaults.global.plugins.streaming={duration:1e4,delay:0,frameRate:30,refresh:1e3,onRefresh:null,pause:!1,ttl:void 0},i.default.defaults.global.legend.onClick=function(t,e){var n=e.datasetIndex,i=this.chart,r=i.getDatasetMeta(n);r.hidden=null===r.hidden?!i.data.datasets[n].hidden:null,i.update({duration:0})};var A={x:["x","controlPointPreviousX","controlPointNextX","caretX"],y:["y","controlPointPreviousY","controlPointNextY","caretY"]};function R(t){var e,n,r,o,s,a,c=this,d=t&&t.preservation;d&&(n=c.lastActive,r=(e=c.tooltip)._lastActive,c._bufferedRender=!0,(s=c.legend)&&(a=s.update,s.update=P.noop)),i.default.prototype.update.apply(c,arguments),d&&(c._bufferedRender=!1,c._bufferedRequest=null,c.lastActive=n,e._lastActive=r,s&&(s.update=a),c.animating?i.default.animationService.animations.forEach(function(t){t.chart===c&&c.render({duration:16.66*(t.numSteps-t.currentStep)})}):c.data.datasets.forEach(function(t,e){c.getDatasetMeta(e).controller.transition(1)}),e._active&&e.update(!0),(o=c.streaming.lastMouseEvent)&&c.eventHandler(o))}function F(){var t,e=this,n=e._active&&e._active[0];return n?(t=e._chart.getDatasetMeta(n._datasetIndex),e._streaming=E(0,A,t)):e._streaming={},i.default.Tooltip.prototype.update.apply(e,arguments)}var z={id:"streaming",beforeInit:function(t){var e=t.streaming=t.streaming||{},n=e.canvas=t.canvas,i=e.mouseEventListener=function(n){var i=P.getRelativePosition(n,t);e.lastMouseEvent={type:"mousemove",chart:t,native:n,x:i.x,y:i.y}};n.addEventListener("mousedown",i),n.addEventListener("mouseup",i)},afterInit:function(t){t.update=R,t.tooltip.update=F},beforeUpdate:function(t){var e=t.options,n=e.scales;return n&&P.each(n.xAxes.concat(n.yAxes),function(t){"realtime"!==t.type&&"time"!==t.type||(e.elements.line.capBezierPoints=!1)}),t.annotation?d.attachChart(t):d.detachChart(t),t.resetZoom?m.attachChart(t):m.detachChart(t),!0},afterUpdate:function(t){var e=t.streaming,n=!0;(function(t){P.each(t.data.datasets,function(e,n){var i,r,o=t.getDatasetMeta(n),s=o.data||[],a=o.dataset;for(i=0,r=s.length;i<r;++i)s[i]._streaming=E(0,A,o);a&&(a._streaming=E(0,A,o))})})(t),P.each(t.scales,function(t){t instanceof N&&(n&=a.resolveOption(t,"pause"))}),n?a.stopFrameRefreshTimer(e):a.startFrameRefreshTimer(e,function(){!function(t){var e=t.streaming,n=1e3/(Math.max(t.options.plugins.streaming.frameRate,0)||30),i=e.lastDrawn+n||0,r=Date.now(),o=e.lastMouseEvent;i<=r&&(t.animating||t.tooltip._start||t.draw(),o&&t.eventHandler(o),e.lastDrawn=i+n>r?i:r)}(t)})},beforeDatasetDraw:function(t,e){var n=e.meta,i=t.chartArea,r={left:0,top:0,right:t.width,bottom:t.height};return n.xAxisID&&n.controller.getScaleForId(n.xAxisID)instanceof N&&(r.left=i.left,r.right=i.right),n.yAxisID&&n.controller.getScaleForId(n.yAxisID)instanceof N&&(r.top=i.top,r.bottom=i.bottom),B.clipArea(t.ctx,r),!0},afterDatasetDraw:function(t){B.unclipArea(t.ctx)},beforeEvent:function(t,e){var n=t.streaming;return"mousemove"===e.type?n.lastMouseEvent=e:"mouseout"===e.type&&delete n.lastMouseEvent,!0},destroy:function(t){var e=t.streaming,n=e.canvas,i=e.mouseEventListener;a.stopFrameRefreshTimer(e),delete t.update,delete t.tooltip.update,n.removeEventListener("mousedown",i),n.removeEventListener("mouseup",i),P.each(t.scales,function(t){t instanceof N&&t.destroy()})}};return i.default.helpers.streaming=a,i.default.plugins.register(z),z}(n("MO+k"),n("wd/R"))},D8XL:function(t,e,n){"use strict";n.r(e),n.d(e,"TradingModule",function(){return At});var i=n("ofXK"),r=n("tyNb"),o=n("P+IX"),s=n("fXoL"),a=n("tqRt");const c=Object(a.p)("[Trading-Trade] Trading starting"),d=Object(a.p)("[Trading-Trade] Trading started"),l=Object(a.p)("[Trading-Trade] Trade payload",Object(a.v)()),u=Object(a.p)("[Trading-Trade] Trading ending"),p=Object(a.p)("[Trading-Trade] Trading ended");Object(a.p)("[Trading-Trade] Trading Error",Object(a.v)());var h=function(t){return t[t.DISCONNECTED=0]="DISCONNECTED",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.DISCONNECTING=3]="DISCONNECTING",t}({});const b={connected:h.DISCONNECTED,trades:[],lastTrade:[]},f=Object(a.r)(b,Object(a.u)(c,t=>Object.assign(Object.assign({},t),{connected:h.CONNECTING})),Object(a.u)(d,t=>Object.assign(Object.assign({},t),{connected:h.CONNECTED})),Object(a.u)(p,t=>Object.assign(Object.assign({},t),{connected:h.DISCONNECTED,trades:b.trades})),Object(a.u)(u,t=>Object.assign(Object.assign({},t),{connected:h.DISCONNECTING})),Object(a.u)(l,(t,e)=>Object.assign(Object.assign({},t),{lastTrade:[...e.trades],trades:[...t.trades,...e.trades]})));function m(t,e){return f(t,e)}const g=Object(a.p)("[Trading-Book] Book starting"),v=Object(a.p)("[Trading-Book] Book started"),O=Object(a.p)("[Trading-Book] Book snapshot",Object(a.v)()),y=Object(a.p)("[Trading-Book] Book update",Object(a.v)()),k=Object(a.p)("[Trading-Book] Book ending"),x=Object(a.p)("[Trading-Book] Book ended");Object(a.p)("[Trading-Book] Book Error",Object(a.v)());var w=function(t){return t[t.price=0]="price",t[t.volume=1]="volume",t[t.timestamp=2]="timestamp",t}({});const C=Array.from({length:10},t=>new Array(3).fill(0)),_={connected:h.DISCONNECTED,bid:C,ask:C,error:""};function S(t,e,n=!1,i=10){if(!e)return t;let r=[...t];return n&&r.reverse(),e.forEach(t=>{let e=[...t.map(t=>+t)];e.length>3&&e.pop();const i=+t[w.price],o=+t[w.volume];if(t.length>3)n?r.unshift(e):r.push(e);else{const t=r.findIndex(t=>i<=t[w.price]);-1===t?r.push(e):0===o?r.splice(t,1):r.splice(t,r[t][w.price]===i?1:0,e)}}),n&&r.reverse(),r=r.slice(0,i),r}const T=Object(a.r)(_,Object(a.u)(g,t=>Object.assign(Object.assign({},t),{connected:h.CONNECTING})),Object(a.u)(v,t=>Object.assign(Object.assign({},t),{connected:h.CONNECTED})),Object(a.u)(x,t=>Object.assign(Object.assign({},t),{connected:h.DISCONNECTED})),Object(a.u)(k,t=>Object.assign(Object.assign({},t),{connected:h.DISCONNECTING})),Object(a.u)(O,(t,e)=>Object.assign(Object.assign({},t),{bid:[...e.book.bs.map(t=>t.map(t=>+t))],ask:[...e.book.as.map(t=>t.map(t=>+t))]})),Object(a.u)(y,(t,e)=>Object.assign(Object.assign({},t),{bid:S(t.bid,e.book.b,!0),ask:S(t.ask,e.book.a)})));function j(t,e){return T(t,e)}const D="trading";function I(t,e){return Object(a.n)({trades:m,book:j})(t,e)}const M=Object(a.q)(D),N=Object(a.s)(M,t=>t.trades),P=(Object(a.s)(N,t=>t.connected),Object(a.s)(N,t=>t.trades),Object(a.s)(N,t=>t.lastTrade)),B=Object(a.s)(M,t=>t.book),E=(Object(a.s)(B,t=>t.connected),Object(a.s)(B,t=>t.ask)),A=Object(a.s)(B,t=>t.bid);n("A/5D");var R=n("LPYB");const F=["tradeChart"];let z=(()=>{class t{constructor(){this.lastTrade=[],this.datasets=[{label:"Bitcoin ($)",fill:!1,backgroundColor:"rgba(0, 0, 0)",borderColor:"rgba(255,243,222)",data:[],lineTension:0,yAxisID:"left-axis"},{label:"Volume",data:[],type:"bar",yAxisID:"right-axis",barThickness:3}],this.lineChartOptions={responsive:!0,title:{display:!1,text:""},scales:{xAxes:[{type:"realtime",realtime:{duration:6e4,refresh:200,delay:100,pause:!1,ttl:12e4},gridLines:{color:"rgb(200,200,200,0.5)",display:!0}}],yAxes:[{type:"linear",position:"left",display:!0,id:"left-axis",gridLines:{color:"rgb(200,200,200,0.5)",display:!0}},{type:"linear",id:"right-axis",position:"right",stacked:!1,display:!0,gridLines:{drawOnChartArea:!1},ticks:{min:0}}]},elements:{point:{radius:3,hitRadius:4}}}}ngAfterViewInit(){this.subscription=this.trades.subscribe(t=>{t&&(this.lastTrade=[...t],t.forEach((t,e)=>{this.datasets[0].data.push({x:1e3*+t.time,y:+t.price}),0===e?this.datasets[1].data.push({x:1e3*+t.time,y:+t.volume}):this.datasets[1].data[this.datasets[1].data.length-1].y+=+t.volume}),this.tradeChart.update("none"))})}ngOnInit(){}ngOnDestroy(){var t;null===(t=this.subscription)||void 0===t||t.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Ib({type:t,selectors:[["app-trade-chart"]],viewQuery:function(t,e){if(1&t&&s.Ac(F,1),2&t){let t;s.nc(t=s.cc())&&(e.tradeChart=t.first)}},inputs:{trades:"trades"},decls:3,vars:3,consts:[[1,"trading-chart"],["baseChart","","id","tradeChart",3,"chartType","datasets","options"],["tradeChart","base-chart"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Pb(1,"canvas",1,2),s.Tb()),2&t&&(s.Db(1),s.kc("chartType","line")("datasets",e.datasets)("options",e.lineChartOptions))},directives:[R.a],styles:[".trading-chart[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;top:0;left:0}"]}),t})(),$=(()=>{class t{constructor(t){this.store=t}ngOnInit(){this.store.dispatch(c()),this.lastTrade$=this.store.select(P)}ngOnDestroy(){this.store.dispatch(u())}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(a.i))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-trade-chart-container"]],decls:1,vars:1,consts:[[3,"trades"]],template:function(t,e){1&t&&s.Pb(0,"app-trade-chart",0),2&t&&s.kc("trades",e.lastTrade$)},directives:[z],styles:["app-trade-chart[_ngcontent-%COMP%]{width:100%;height:100%}"]}),t})();var U=n("Kj3r"),Y=n("OaSA");function W(t,e){1&t&&(s.Ub(0,"th",8),s.xc(1," $ "),s.Tb())}function L(t,e){if(1&t&&(s.Ub(0,"td",9),s.xc(1),s.fc(2,"number"),s.Tb()),2&t){const t=e.$implicit;s.Db(1),s.zc(" ",s.hc(2,1,t[0],"1.2-5")," ")}}function H(t,e){1&t&&(s.Ub(0,"th",8),s.xc(1," # "),s.Tb())}function q(t,e){if(1&t&&(s.Ub(0,"td",9),s.xc(1),s.fc(2,"number"),s.Tb()),2&t){const t=e.$implicit;s.Db(1),s.zc(" ",s.hc(2,1,t[1],"1.5-5")," ")}}function X(t,e){1&t&&(s.Ub(0,"th",8),s.xc(1," Date/Time "),s.Tb())}function G(t,e){if(1&t&&(s.Ub(0,"td",9),s.xc(1),s.fc(2,"date"),s.Tb()),2&t){const t=e.$implicit;s.Db(1),s.zc(" ",s.hc(2,1,1e3*t[2],"mediumTime")," ")}}function Z(t,e){1&t&&s.Pb(0,"tr",10)}function V(t,e){1&t&&s.Pb(0,"tr",11)}let K=(()=>{class t{constructor(){this.orderBook=[][3],this.isBid=!1,this.displayedColumns=["price","volume","date"]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Ib({type:t,selectors:[["app-order-book"]],inputs:{orderBook:"orderBook",isBid:"isBid"},decls:14,vars:6,consts:[["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","price"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","volume"],["matColumnDef","date"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.Ub(0,"h4"),s.xc(1),s.Tb(),s.Ub(2,"table",0),s.Sb(3,1),s.wc(4,W,2,0,"th",2),s.wc(5,L,3,4,"td",3),s.Rb(),s.Sb(6,4),s.wc(7,H,2,0,"th",2),s.wc(8,q,3,4,"td",3),s.Rb(),s.Sb(9,5),s.wc(10,X,2,0,"th",2),s.wc(11,G,3,4,"td",3),s.Rb(),s.wc(12,Z,1,0,"tr",6),s.wc(13,V,1,0,"tr",7),s.Tb()),2&t&&(s.Db(1),s.yc(e.isBid?"Buy":"Sell"),s.Db(1),s.Gb("bid-group",e.isBid),s.kc("dataSource",e.orderBook),s.Db(10),s.kc("matHeaderRowDef",e.displayedColumns),s.Db(1),s.kc("matRowDefColumns",e.displayedColumns))},directives:[Y.j,Y.c,Y.e,Y.b,Y.g,Y.i,Y.d,Y.a,Y.f,Y.h],pipes:[i.e,i.d],styles:[".mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{padding:0 .2rem;text-align:center}.mat-header-cell[_ngcontent-%COMP%]{color:wheat}.mat-cell[_ngcontent-%COMP%]{color:red}mat-footer-row[_ngcontent-%COMP%], mat-header-row[_ngcontent-%COMP%], mat-row[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%], th.mat-header-cell[_ngcontent-%COMP%]{border-bottom-color:wheat}.bid-group[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{color:#0f0}h4[_ngcontent-%COMP%]{text-align:center;color:wheat;margin:1rem .2rem .2rem}@media screen and (min-width:1200px){h4[_ngcontent-%COMP%]{margin-top:2rem}}td.mat-cell[_ngcontent-%COMP%]:first-of-type, td.mat-cell[_ngcontent-%COMP%]:last-of-type, th.mat-header-cell[_ngcontent-%COMP%]:first-of-type, th.mat-header-cell[_ngcontent-%COMP%]:last-of-type{padding:0 .5rem}tr.mat-header-row[_ngcontent-%COMP%], tr.mat-row[_ngcontent-%COMP%]{height:1.5rem}table[_ngcontent-%COMP%]{font-family:Inconsolata,monospace;background:transparent;border-color:wheat;width:100%;min-width:220px}"]}),t})(),J=(()=>{class t{constructor(t){this.store=t}ngOnInit(){this.askBook$=this.store.select(E).pipe(Object(U.a)(100)),this.bidBook$=this.store.select(A).pipe(Object(U.a)(100)),this.store.dispatch(g())}ngOnDestroy(){this.store.dispatch(k())}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(a.i))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-order-book-container"]],decls:2,vars:4,consts:[[3,"isBid","orderBook"]],template:function(t,e){1&t&&(s.Pb(0,"app-order-book",0),s.Pb(1,"app-order-book",0)),2&t&&(s.kc("isBid",!0)("orderBook",e.bidBook$),s.Db(1),s.kc("isBid",!1)("orderBook",e.askBook$))},directives:[K],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}app-order-book[_ngcontent-%COMP%]{padding:0 1rem}@media screen and (min-width:1200px){[_nghost-%COMP%]{flex-direction:row}}"]}),t})();const Q=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Ib({type:t,selectors:[["app-trading"]],decls:3,vars:0,consts:[[1,"trading-section"]],template:function(t,e){1&t&&(s.Ub(0,"section",0),s.Pb(1,"app-trade-chart-container"),s.Pb(2,"app-order-book-container"),s.Tb())},directives:[$,J],styles:["[_nghost-%COMP%]{background:linear-gradient(90deg,rgba(2,0,36,.95),rgba(0,0,0,.7) 90%),url(dollardollarbillsyo.7a96ad9dbae20a92f183.jpg) 50%/cover no-repeat;display:flex;justify-content:stretch;width:100%;flex-direction:column;min-height:100%;padding-bottom:1rem}.trading-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-around}.trading-section[_ngcontent-%COMP%]   app-trade-chart-container[_ngcontent-%COMP%]{width:80%;display:flex;flex-direction:column;align-items:center;margin-top:1rem;position:relative}@media screen and (min-width:900px){.trading-section[_ngcontent-%COMP%]{margin-top:64px}}@media screen and (min-width:1200px){[_nghost-%COMP%]{height:100%}.trading-section[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start;flex-wrap:wrap;justify-content:center}.trading-section[_ngcontent-%COMP%]   app-trade-chart-container[_ngcontent-%COMP%]{width:45%}.trading-section[_ngcontent-%COMP%]   app-order-book-container[_ngcontent-%COMP%]{padding-left:1rem}}"]}),t})(),canActivate:[o.a]}];let tt=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(Q)],r.i]}),t})();var et=n("7bNT"),nt=n("vkgz"),it=n("XNiG"),rt=n("7o/Q"),ot=n("HDdC"),st=n("quSY"),at=n("jtHE");const ct={url:"",deserializer:t=>JSON.parse(t.data),serializer:t=>JSON.stringify(t)};class dt extends it.a{constructor(t,e){if(super(),t instanceof ot.a)this.destination=e,this.source=t;else{const e=this._config=Object.assign({},ct);if(this._output=new it.b,"string"==typeof t)e.url=t;else for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);if(!e.WebSocketCtor&&WebSocket)e.WebSocketCtor=WebSocket;else if(!e.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new at.a}}lift(t){const e=new dt(this._config,this.destination);return e.operator=t,e.source=this,e}_resetState(){this._socket=null,this.source||(this.destination=new at.a),this._output=new it.b}multiplex(t,e,n){const i=this;return new ot.a(r=>{try{i.next(t())}catch(s){r.error(s)}const o=i.subscribe(t=>{try{n(t)&&r.next(t)}catch(s){r.error(s)}},t=>r.error(t),()=>r.complete());return()=>{try{i.next(e())}catch(s){r.error(s)}o.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:t,protocol:e,url:n,binaryType:i}=this._config,r=this._output;let o=null;try{o=e?new t(n,e):new t(n),this._socket=o,i&&(this._socket.binaryType=i)}catch(a){return void r.error(a)}const s=new st.a(()=>{this._socket=null,o&&1===o.readyState&&o.close()});o.onopen=t=>{const{_socket:e}=this;if(!e)return o.close(),void this._resetState();const{openObserver:n}=this._config;n&&n.next(t);const i=this.destination;this.destination=rt.a.create(e=>{if(1===o.readyState)try{const{serializer:t}=this._config;o.send(t(e))}catch(t){this.destination.error(t)}},t=>{const{closingObserver:e}=this._config;e&&e.next(void 0),t&&t.code?o.close(t.code,t.reason):r.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:t}=this._config;t&&t.next(void 0),o.close(),this._resetState()}),i&&i instanceof at.a&&s.add(i.subscribe(this.destination))},o.onerror=t=>{this._resetState(),r.error(t)},o.onclose=t=>{this._resetState();const{closeObserver:e}=this._config;e&&e.next(t),t.wasClean?r.complete():r.error(t)},o.onmessage=t=>{try{const{deserializer:e}=this._config;r.next(e(t))}catch(e){r.error(e)}}}_subscribe(t){const{source:e}=this;return e?e.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(()=>{const{_socket:t}=this;0===this._output.observers.length&&(t&&1===t.readyState&&t.close(),this._resetState())}),t)}unsubscribe(){const{_socket:t}=this;t&&1===t.readyState&&t.close(),this._resetState(),super.unsubscribe()}}var lt=n("AytR"),ut=n("2Vo4"),pt=n("EY2u"),ht=n("PqYM"),bt=n("eIep"),ft=n("SpAZ"),mt=n("JIr8"),gt=n("zx2A");class vt{constructor(t,e){this.notifier=t,this.source=e}call(t,e){return e.subscribe(new Ot(t,this.notifier,this.source))}}class Ot extends gt.b{constructor(t,e,n){super(t),this.notifier=e,this.source=n}error(t){if(!this.isStopped){let n=this.errors,i=this.retries,r=this.retriesSubscription;if(i)this.errors=void 0,this.retriesSubscription=void 0;else{n=new it.b;try{const{notifier:t}=this;i=t(n)}catch(e){return super.error(e)}r=Object(gt.c)(i,new gt.a(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=i,this.retriesSubscription=r,n.next(t)}}_unsubscribe(){const{errors:t,retriesSubscription:e}=this;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0}notifyNext(){const{_unsubscribe:t}=this;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)}}var yt=n("l7GE"),kt=n("ZUHj");class xt{constructor(t){this.delayDurationSelector=t}call(t,e){return e.subscribe(new wt(t,this.delayDurationSelector))}}class wt extends yt.a{constructor(t,e){super(t),this.delayDurationSelector=e,this.completed=!1,this.delayNotifierSubscriptions=[],this.index=0}notifyNext(t,e,n,i,r){this.destination.next(t),this.removeSubscription(r),this.tryComplete()}notifyError(t,e){this._error(t)}notifyComplete(t){const e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()}_next(t){const e=this.index++;try{const n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(n){this.destination.error(n)}}_complete(){this.completed=!0,this.tryComplete(),this.unsubscribe()}removeSubscription(t){t.unsubscribe();const e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue}tryDelay(t,e){const n=Object(kt.a)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))}tryComplete(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()}}const Ct=Object(a.p)("[Trading Traffic] new traffic",Object(a.v)()),_t=Object(a.p)("[Trading Traffic] Traffic Cop unhandled traffic",Object(a.v)()),St=lt.a.BITCOIN_WEBSOCKET_URL,Tt=lt.a.BITCOIN_RECONNECT_INTERVAL;let jt=(()=>{class t{constructor(t){this.store=t,this.messagesSubject$=new ut.a(null),this.messages$=this.messagesSubject$.pipe(Object(bt.a)(ft.a),Object(mt.a)(t=>{throw t})),this.subscription=null,this.bookStarted=!1,this.tradeStarted=!1}connect(t={reconnect:!1}){if(!this.socket$||this.socket$.closed){this.socket$=this.getNewWebSocket();const e=this.socket$.pipe(t.reconnect?this.reconnect:t=>t,Object(nt.a)({error:t=>console.log(t)}),Object(mt.a)(t=>pt.a));this.messagesSubject$.next(e)}}reconnect(t){return t.pipe((e=t=>{return t.pipe(Object(nt.a)(t=>console.log("[TradingService] Try to reconnect",t)),(e=t=>Object(ht.a)(Tt),t=>t.lift(new xt(e))));var e},t=>t.lift(new vt(e,t))));var e}close(){var t;null===(t=this.socket$)||void 0===t||t.complete(),this.socket$=void 0}sendMessage(t){this.socket$.next(t)}getNewWebSocket(){return new dt({url:St,openObserver:{next:()=>{}},closeObserver:{next:()=>{var t;null===(t=this.socket$)||void 0===t||t.complete(),this.socket$=void 0,this.tradeStarted=!1,this.bookStarted=!1,this.store.dispatch(p()),this.store.dispatch(x())}}})}startTradeFeed(){this.tradeStarted=!0,this.connect(),this.checkSubscription(),this.sendMessage({event:"subscribe",pair:["XBT/USD"],subscription:{name:"trade"}})}checkSubscription(){this.subscription||(this.subscription=this.messages$.subscribe(t=>{this.store.dispatch(Ct({data:t}))}))}stopTradeFeed(){this.sendMessage({event:"unsubscribe",pair:["XBT/USD"],subscription:{name:"trade"}}),this.tradeStarted=!1,this.bookStarted||this.tradeStarted||this.close()}startBookFeed(){this.bookStarted=!0,this.connect(),this.checkSubscription(),this.sendMessage({event:"subscribe",pair:["XBT/USD"],subscription:{name:"book"}})}stopBookFeed(){this.sendMessage({event:"unsubscribe",pair:["XBT/USD"],subscription:{name:"book"}}),this.bookStarted=!1,this.bookStarted||this.tradeStarted||this.close()}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(a.i))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Dt=(()=>{class t{constructor(t,e){this.actions$=t,this.service=e,this.connectTrade$=Object(et.d)(()=>this.actions$.pipe(Object(et.e)(c),Object(nt.a)(()=>this.service.startTradeFeed())),{dispatch:!1}),this.disconnectTrade$=Object(et.d)(()=>this.actions$.pipe(Object(et.e)(u),Object(nt.a)(()=>this.service.stopTradeFeed())),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(et.a),s.Yb(jt))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var It=n("lJxs"),Mt=function(t){return t.Book="book-10",t.Trade="trade",t}({}),Nt=function(t){return t.Ping="ping",t.Pong="pong",t.Heartbeat="heartbeat",t.SystemStatus="systemStatus",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",t.SubscriptionStatus="subscriptionStatus",t}({});let Pt=(()=>{class t{constructor(t){this.actions$=t,this.trafficCopEffect$=Object(et.d)(()=>this.actions$.pipe(Object(et.e)(Ct),Object(It.a)(t=>{var e,n,i,r;if(Array.isArray(t.data))switch(t.data[t.data.length-2]){case Mt.Trade:const e=t.data[1].map(t=>({price:t[0],volume:t[1],time:t[2],side:t[3],orderType:t[4],misc:t[5]}));return l({trades:e});case Mt.Book:const n=t.data[1];if((null==n?void 0:n.as)&&(null==n?void 0:n.bs))return O({book:n});if((null==n?void 0:n.a)||(null==n?void 0:n.b))return y({book:n})}else{const o=t.data;if(null==o?void 0:o.event)switch(o.event){case Nt.SubscriptionStatus:if((null==o?void 0:o.status)==Nt.Subscribe){if((null===(e=null==o?void 0:o.subscription)||void 0===e?void 0:e.name)==Mt.Trade)return d();if((null===(n=null==o?void 0:o.subscription)||void 0===n?void 0:n.name)==Mt.Book)return v()}else if((null==o?void 0:o.status)==Nt.Unsubscribe){if((null===(i=null==o?void 0:o.subscription)||void 0===i?void 0:i.name)==Mt.Trade)return p();if((null===(r=null==o?void 0:o.subscription)||void 0===r?void 0:r.name)==Mt.Book)return x()}}}return _t({data:t.data})})))}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(et.a))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Bt=n("pKmL");let Et=(()=>{class t{constructor(t,e){this.actions$=t,this.service=e,this.connectBook$=Object(et.d)(()=>this.actions$.pipe(Object(et.e)(g),Object(nt.a)(()=>this.service.startBookFeed())),{dispatch:!1}),this.disconnectBook$=Object(et.d)(()=>this.actions$.pipe(Object(et.e)(k),Object(nt.a)(()=>this.service.stopBookFeed())),{dispatch:!1})}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(et.a),s.Yb(jt))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),At=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[i.b,tt,a.k.forFeature(D,I),et.b.forFeature([Pt,Dt,Et]),Bt.a,R.b]]}),t})()}}]);